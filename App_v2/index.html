<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â≠¶‰∏≠Êñá - H·ªçc T·ª´ V·ª±ng Ti·∫øng Trung</title>
    <meta name="description"
        content="·ª®ng d·ª•ng h·ªçc t·ª´ v·ª±ng ti·∫øng Trung v·ªõi ph√°t √¢m, flashcard, quiz v√† h·ªá th·ªëng √¥n t·∫≠p th√¥ng minh">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- SheetJS for Excel parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="logo">
                <span class="logo-icon">Ê±â</span>
                <h1>Â≠¶‰∏≠Êñá</h1>
            </div>
            <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()" title="Ch·∫ø ƒë·ªô s√°ng/t·ªëi">
                <span class="theme-icon">üåô</span>
            </button>
            <div class="header-stats">
                <div class="stat-item">
                    <span class="stat-value" id="totalWords">0</span>
                    <span class="stat-label">T·ª´ v·ª±ng</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="learnedWords">0</span>
                    <span class="stat-label">ƒê√£ thu·ªôc</span>
                </div>
                <div class="stat-item review-stat" onclick="navigateTo('review')">
                    <span class="stat-value" id="dueToday">0</span>
                    <span class="stat-label">C·∫ßn √¥n</span>
                    <span class="review-badge-header" id="reviewBadge" style="display: none;"></span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Home Screen -->
            <section class="screen active" id="homeScreen">
                <div class="welcome-card">
                    <h2>Ch√†o m·ª´ng b·∫°n! üéâ</h2>
                    <p>B·∫Øt ƒë·∫ßu h√†nh tr√¨nh h·ªçc ti·∫øng Trung c·ªßa b·∫°n</p>
                </div>

                <!-- Review Alert -->
                <div class="review-alert" id="reviewAlert" style="display: none;">
                    <div class="alert-content">
                        <span class="alert-icon">üîî</span>
                        <div class="alert-text">
                            <strong id="alertCount">0</strong> t·ª´ c·∫ßn √¥n t·∫≠p h√¥m nay
                        </div>
                    </div>
                    <button class="btn btn-sm" onclick="navigateTo('review')">√în ngay</button>
                </div>

                <div class="action-grid">
                    <button class="action-card" onclick="navigateTo('groups')">
                        <div class="action-icon">üìÅ</div>
                        <h3>Nh√≥m t·ª´</h3>
                        <p>Qu·∫£n l√Ω theo ch·ªß ƒë·ªÅ</p>
                    </button>
                    <button class="action-card" onclick="navigateTo('vocabulary')">
                        <div class="action-icon">üìö</div>
                        <h3>T·ª´ V·ª±ng</h3>
                        <p>Danh s√°ch t·ª´</p>
                    </button>
                    <button class="action-card has-badge" onclick="navigateTo('review')">
                        <div class="action-icon">üîÑ</div>
                        <h3>√în t·∫≠p</h3>
                        <p>SRS th√¥ng minh</p>
                        <span class="card-badge" id="reviewCardBadge"></span>
                    </button>
                    <button class="action-card" onclick="navigateTo('flashcard')">
                        <div class="action-icon">üé¥</div>
                        <h3>Flashcard</h3>
                        <p>H·ªçc th·∫ª ghi nh·ªõ</p>
                    </button>
                    <button class="action-card" onclick="navigateTo('quiz')">
                        <div class="action-icon">‚ùì</div>
                        <h3>Quiz</h3>
                        <p>Ki·ªÉm tra tr√≠ nh·ªõ</p>
                    </button>
                    <button class="action-card" onclick="navigateTo('analytics')">
                        <div class="action-icon">üìä</div>
                        <h3>Th·ªëng k√™</h3>
                        <p>Ph√¢n t√≠ch ti·∫øn ƒë·ªô</p>
                    </button>
                    <button class="action-card" onclick="navigateTo('import')">
                        <div class="action-icon">üì•</div>
                        <h3>Import</h3>
                        <p>Nh·∫≠p t·ª´ Excel</p>
                    </button>
                    <button class="action-card" onclick="navigateTo('settings')">
                        <div class="action-icon">‚öôÔ∏è</div>
                        <h3>C√†i ƒë·∫∑t</h3>
                        <p>API Key & t√πy ch·ªânh</p>
                    </button>
                </div>

                <div class="recent-section">
                    <h3>üìä Ti·∫øn ƒë·ªô h·ªçc t·∫≠p</h3>
                    <div class="progress-overview">
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="progressBar"></div>
                        </div>
                        <span class="progress-text" id="progressText">0%</span>
                    </div>
                </div>

                <!-- Review Calendar Preview -->
                <div class="calendar-section">
                    <h3>üìÖ L·ªãch √¥n t·∫≠p tu·∫ßn n√†y</h3>
                    <div class="calendar-preview" id="homeCalendar"></div>
                </div>
            </section>

            <!-- Groups Screen -->
            <section class="screen" id="groupsScreen">
                <div class="screen-header">
                    <button class="back-btn" onclick="navigateTo('home')">‚Üê Quay l·∫°i</button>
                    <h2>üìÅ Nh√≥m t·ª´ v·ª±ng</h2>
                </div>

                <div class="groups-controls">
                    <button class="btn btn-primary" onclick="openAddGroupModal()">+ T·∫°o nh√≥m m·ªõi</button>
                </div>

                <div class="groups-list" id="groupsList">
                    <!-- Groups will be rendered here -->
                </div>
            </section>

            <!-- Vocabulary Screen -->
            <section class="screen" id="vocabularyScreen">
                <div class="screen-header">
                    <button class="back-btn" onclick="navigateTo('home')">‚Üê Quay l·∫°i</button>
                    <h2>üìö Danh s√°ch t·ª´ v·ª±ng</h2>
                </div>

                <!-- Group Filter -->
                <div class="group-filter-container" id="groupFilterContainer">
                    <!-- Group filters will be rendered here -->
                </div>

                <div class="vocab-controls">
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm t·ª´ v·ª±ng..."
                            oninput="searchVocabulary()">
                    </div>
                    <button class="btn btn-secondary" onclick="toggleSelectMode()" id="selectModeBtn">‚òëÔ∏è Ch·ªçn</button>
                    <button class="btn btn-primary" onclick="openAddModal()">+ Th√™m t·ª´</button>
                </div>

                <!-- Bulk Actions Toolbar (hidden by default) -->
                <div class="bulk-toolbar" id="bulkToolbar" style="display: none;">
                    <label class="select-all-label">
                        <input type="checkbox" id="selectAllCheckbox" onchange="toggleSelectAll()">
                        <span>Ch·ªçn t·∫•t c·∫£</span>
                    </label>
                    <span class="selected-count">ƒê√£ ch·ªçn: <strong id="selectedCount">0</strong></span>
                    <button class="btn btn-danger btn-sm" onclick="deleteSelected()" id="deleteSelectedBtn" disabled>üóëÔ∏è
                        X√≥a ƒë√£ ch·ªçn</button>
                    <button class="btn btn-secondary btn-sm" onclick="cancelSelectMode()">H·ªßy</button>
                </div>

                <div class="vocab-list" id="vocabList">
                    <!-- Vocabulary items will be rendered here -->
                </div>
            </section>

            <!-- Review Screen (SRS) -->
            <section class="screen" id="reviewScreen">
                <div class="screen-header">
                    <button class="back-btn" onclick="navigateTo('home')">‚Üê Quay l·∫°i</button>
                    <h2>üîÑ √în t·∫≠p h√¥m nay</h2>
                </div>

                <!-- Group selector for review -->
                <div class="review-group-selector">
                    <label>Ch·ªçn nh√≥m:</label>
                    <select id="reviewGroupSelect" onchange="initReviewSession(this.value)">
                        <option value="all">T·∫•t c·∫£</option>
                        <!-- Groups will be populated -->
                    </select>
                </div>

                <div class="review-container" id="reviewContainer">
                    <div class="review-progress">
                        <span id="reviewCurrent">0</span> / <span id="reviewTotal">0</span>
                    </div>

                    <div class="review-card" id="reviewCard" onclick="flipReviewCard()">
                        <div class="review-card-inner">
                            <div class="review-card-front">
                                <span class="chinese-char" id="reviewChinese">‰Ω†Â•Ω</span>
                                <button class="speak-btn"
                                    onclick="event.stopPropagation(); speakChinese(document.getElementById('reviewChinese').textContent)">üîä</button>
                            </div>
                            <div class="review-card-back">
                                <span class="pinyin" id="reviewPinyin">n«ê h«éo</span>
                                <span class="meaning" id="reviewMeaning">Xin ch√†o</span>
                                <span class="example" id="reviewExample"></span>
                            </div>
                        </div>
                    </div>

                    <p class="review-hint">Click th·∫ª ƒë·ªÉ xem ƒë√°p √°n</p>

                    <div class="review-actions" id="reviewActions" style="display: none;">
                        <button class="btn btn-danger" onclick="answerReview(false)">‚ùå Ch∆∞a nh·ªõ</button>
                        <button class="btn btn-success" onclick="answerReview(true)">‚úÖ ƒê√£ nh·ªõ</button>
                    </div>
                </div>

                <div class="review-complete" id="reviewComplete" style="display: none;">
                    <div class="complete-card">
                        <span class="complete-icon">üéâ</span>
                        <h3>Ho√†n th√†nh!</h3>
                        <p>B·∫°n ƒë√£ √¥n t·∫≠p <strong id="reviewedCount">0</strong> t·ª´</p>
                        <button class="btn btn-primary" onclick="navigateTo('home')">V·ªÅ trang ch·ªß</button>
                    </div>
                </div>

                <div class="empty-state" id="reviewEmpty" style="display: none;">
                    <p>‚ú® Kh√¥ng c√≥ t·ª´ n√†o c·∫ßn √¥n h√¥m nay!</p>
                    <p class="empty-sub">H√£y quay l·∫°i sau ho·∫∑c h·ªçc th√™m t·ª´ m·ªõi</p>
                    <button class="btn btn-primary" onclick="navigateTo('vocabulary')">Th√™m t·ª´ v·ª±ng</button>
                </div>
            </section>

            <!-- Flashcard Screen -->
            <section class="screen" id="flashcardScreen">
                <div class="screen-header">
                    <button class="back-btn" onclick="navigateTo('home')">‚Üê Quay l·∫°i</button>
                    <h2>üé¥ Flashcard</h2>
                </div>

                <!-- Group selector for flashcard -->
                <div class="flashcard-group-selector">
                    <label>Ch·ªçn nh√≥m:</label>
                    <select id="flashcardGroupSelect" onchange="initFlashcardWithGroup(this.value)">
                        <option value="all">T·∫•t c·∫£</option>
                    </select>
                </div>

                <div class="flashcard-container">
                    <div class="flashcard-progress">
                        <span id="flashcardCurrent">0</span> / <span id="flashcardTotal">0</span>
                    </div>

                    <div class="flashcard" id="flashcard" onclick="flipCard()">
                        <div class="flashcard-inner">
                            <div class="flashcard-front">
                                <span class="chinese-char" id="flashcardChinese">‰Ω†Â•Ω</span>
                                <button class="speak-btn"
                                    onclick="event.stopPropagation(); speakChinese(document.getElementById('flashcardChinese').textContent)">üîä</button>
                            </div>
                            <div class="flashcard-back">
                                <span class="pinyin" id="flashcardPinyin">n«ê h«éo</span>
                                <span class="meaning" id="flashcardMeaning">Xin ch√†o</span>
                                <span class="example" id="flashcardExample"></span>
                            </div>
                        </div>
                    </div>

                    <div class="flashcard-actions">
                        <button class="btn btn-danger" onclick="markWord(false)">‚ùå Ch∆∞a thu·ªôc</button>
                        <button class="btn btn-success" onclick="markWord(true)">‚úÖ ƒê√£ thu·ªôc</button>
                    </div>

                    <div class="flashcard-nav">
                        <button class="btn btn-secondary" onclick="prevCard()">‚Üê Tr∆∞·ªõc</button>
                        <button class="btn btn-secondary" onclick="nextCard()">Sau ‚Üí</button>
                    </div>
                </div>

                <div class="empty-state" id="flashcardEmpty" style="display: none;">
                    <p>üì≠ Ch∆∞a c√≥ t·ª´ v·ª±ng n√†o. H√£y th√™m t·ª´ v·ª±ng tr∆∞·ªõc!</p>
                    <button class="btn btn-primary" onclick="navigateTo('vocabulary')">Th√™m t·ª´ v·ª±ng</button>
                </div>
            </section>

            <!-- Quiz Screen -->
            <section class="screen" id="quizScreen">
                <div class="screen-header">
                    <button class="back-btn" onclick="navigateTo('home')">‚Üê Quay l·∫°i</button>
                    <h2>‚ùì Quiz</h2>
                </div>

                <div class="quiz-setup" id="quizSetup">
                    <!-- Group selector for quiz -->
                    <div class="quiz-group-selector">
                        <label>Ch·ªçn nh√≥m:</label>
                        <select id="quizGroupSelect">
                            <option value="all">T·∫•t c·∫£</option>
                        </select>
                    </div>

                    <!-- Question count selector -->
                    <div class="quiz-count-selector">
                        <label>S·ªë c√¢u h·ªèi: <strong id="questionCountDisplay">10</strong></label>
                        <input type="range" id="questionCountSlider" min="3" max="50" value="10"
                            oninput="document.getElementById('questionCountDisplay').textContent = this.value">
                        <div class="range-labels">
                            <span>3</span>
                            <span>50</span>
                        </div>
                    </div>

                    <h3>Ch·ªçn ch·∫ø ƒë·ªô Quiz</h3>
                    <div class="quiz-modes">
                        <button class="quiz-mode-btn" onclick="startQuizWithGroup('meaning')">
                            <span class="mode-icon">üìñ</span>
                            <span class="mode-title">Ch·ªçn nghƒ©a</span>
                            <span class="mode-desc">Xem ch·ªØ H√°n ‚Üí Ch·ªçn nghƒ©a ƒë√∫ng</span>
                        </button>
                        <button class="quiz-mode-btn" onclick="startQuizWithGroup('character')">
                            <span class="mode-icon">Ê±â</span>
                            <span class="mode-title">Ch·ªçn ch·ªØ</span>
                            <span class="mode-desc">Xem nghƒ©a ‚Üí Ch·ªçn ch·ªØ H√°n ƒë√∫ng</span>
                        </button>
                        <button class="quiz-mode-btn" onclick="startQuizWithGroup('matching')">
                            <span class="mode-icon">üß©</span>
                            <span class="mode-title">Gh√©p th·∫ª</span>
                            <span class="mode-desc">N·ªëi ch·ªØ H√°n v·ªõi nghƒ©a ƒë√∫ng</span>
                        </button>
                        <button class="quiz-mode-btn" onclick="startQuizWithGroup('typing')">
                            <span class="mode-icon">‚úçÔ∏è</span>
                            <span class="mode-title">ƒêi·ªÅn nghƒ©a</span>
                            <span class="mode-desc">Xem ch·ªØ H√°n ‚Üí G√µ nghƒ©a ti·∫øng Vi·ªát</span>
                        </button>
                        <button class="quiz-mode-btn" onclick="startQuizWithGroup('listening')">
                            <span class="mode-icon">üéß</span>
                            <span class="mode-title">Luy·ªán nghe</span>
                            <span class="mode-desc">Nghe ph√°t √¢m ‚Üí Ch·ªçn t·ª´ ƒë√∫ng</span>
                        </button>
                    </div>
                </div>

                <div class="quiz-game" id="quizGame" style="display: none;">
                    <div class="quiz-header">
                        <div class="quiz-progress">
                            C√¢u <span id="quizCurrent">1</span> / <span id="quizTotal">10</span>
                        </div>
                        <div class="quiz-score">
                            ƒêi·ªÉm: <span id="quizScore">0</span>
                        </div>
                    </div>

                    <div class="quiz-question">
                        <div class="question-content" id="questionContent">
                            <span class="question-chinese">‰Ω†Â•Ω</span>
                        </div>
                        <button class="speak-btn quiz-speak" id="quizSpeakBtn"
                            onclick="speakChinese(currentQuizWord)">üîä</button>
                    </div>

                    <div class="quiz-options" id="quizOptions">
                        <!-- Options will be rendered here -->
                    </div>

                    <div class="quiz-actions">
                        <button class="btn btn-secondary" onclick="saveQuizProgress()">üíæ L∆∞u ti·∫øn ƒë·ªô</button>
                        <button class="btn btn-primary" onclick="submitIncompleteQuiz()">üìù N·ªôp b√†i</button>
                    </div>
                </div>

                <!-- Matching Game Container -->
                <div class="matching-game" id="matchingGame" style="display: none;">
                    <div class="quiz-header">
                        <div class="quiz-progress">
                            C·∫∑p <span id="matchingFound">0</span> / <span id="matchingTotal">8</span>
                        </div>
                        <div class="quiz-timer" id="matchingTimer">00:00</div>
                    </div>

                    <div class="matching-grid" id="matchingGrid">
                        <!-- Cards will be rendered here -->
                    </div>

                    <div class="quiz-actions">
                        <button class="btn btn-secondary" onclick="resetMatchingGame()">üîÑ Ch∆°i l·∫°i</button>
                        <button class="btn btn-primary" onclick="quitMatchingGame()">üö™ Tho√°t</button>
                    </div>
                </div>

                <!-- Typing Quiz Container -->
                <div class="quiz-game" id="typingGame" style="display: none;">
                    <div class="quiz-header">
                        <div class="quiz-progress">
                            C√¢u <span id="typingCurrent">1</span> / <span id="typingTotal">10</span>
                        </div>
                        <div class="quiz-score">
                            ƒêi·ªÉm: <span id="typingScore">0</span>
                        </div>
                    </div>
                    <div class="quiz-question">
                        <div class="question-content" id="typingQuestionContent">
                            <span class="question-chinese">‰Ω†Â•Ω</span>
                        </div>
                        <button class="speak-btn quiz-speak" id="typingSpeakBtn" onclick="speakTypingWord()">üîä</button>
                    </div>
                    <div class="typing-answer-area">
                        <input type="text" id="typingInput" class="typing-input" placeholder="G√µ nghƒ©a ti·∫øng Vi·ªát..."
                            onkeydown="if(event.key==='Enter') submitTypingAnswer()">
                        <button class="btn btn-primary" onclick="submitTypingAnswer()">Ki·ªÉm tra</button>
                    </div>
                    <div id="typingFeedback" class="typing-feedback" style="display:none;"></div>
                    <div class="quiz-actions" style="margin-top: 8px;">
                        <button class="btn btn-secondary" onclick="skipTypingQuestion()">‚è≠Ô∏è B·ªè qua</button>
                        <button class="btn btn-primary" onclick="submitIncompleteTypingQuiz()">üìù N·ªôp b√†i</button>
                    </div>
                </div>

                <div class="quiz-result" id="quizResult" style="display: none;">
                    <div class="result-card">
                        <h3 id="resultTitle">üéâ Ho√†n th√†nh!</h3>
                        <div class="result-score">
                            <span class="score-value" id="finalScore">8</span>
                            <span class="score-total" id="scoreTotalDisplay">/ 10</span>
                        </div>
                        <div class="result-stats" id="resultStats"></div>
                        <div class="result-message" id="resultMessage">Xu·∫•t s·∫Øc!</div>
                        <button class="btn btn-primary" onclick="resetQuiz()">L√†m l·∫°i</button>
                    </div>
                </div>

                <div class="empty-state" id="quizEmpty" style="display: none;">
                    <p>üì≠ C·∫ßn √≠t nh·∫•t 4 t·ª´ v·ª±ng ƒë·ªÉ ch∆°i Quiz!</p>
                    <button class="btn btn-primary" onclick="navigateTo('vocabulary')">Th√™m t·ª´ v·ª±ng</button>
                </div>
            </section>

            <!-- Analytics Screen -->
            <section class="screen" id="analyticsScreen">
                <div class="screen-header">
                    <button class="back-btn" onclick="navigateTo('home')">‚Üê Quay l·∫°i</button>
                    <h2>üìä Th·ªëng k√™ h·ªçc t·∫≠p</h2>
                </div>

                <div class="analytics-container">
                    <!-- Overall Stats -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <span class="stat-icon">üìö</span>
                            <span class="stat-number" id="statTotal">0</span>
                            <span class="stat-desc">T·ªïng t·ª´ v·ª±ng</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-icon">‚úÖ</span>
                            <span class="stat-number" id="statLearned">0</span>
                            <span class="stat-desc">ƒê√£ thu·ªôc</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-icon">üîÑ</span>
                            <span class="stat-number" id="statDueToday">0</span>
                            <span class="stat-desc">C·∫ßn √¥n</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-icon">üéØ</span>
                            <span class="stat-number" id="statAccuracy">0%</span>
                            <span class="stat-desc">ƒê·ªô ch√≠nh x√°c</span>
                        </div>
                        <div class="stat-card highlight">
                            <span class="stat-icon">üî•</span>
                            <span class="stat-number" id="statStreak">0 ng√†y</span>
                            <span class="stat-desc">Streak</span>
                        </div>
                    </div>

                    <!-- Mastery Progress -->
                    <div class="analytics-section">
                        <h3>üèÜ M·ª©c ƒë·ªô th√†nh th·∫°o</h3>
                        <div class="mastery-bar-container">
                            <div class="mastery-bar" id="masteryBar"></div>
                        </div>
                        <span class="mastery-text" id="masteryText">0%</span>
                    </div>

                    <!-- Status Distribution -->
                    <div class="analytics-section">
                        <h3>üìà Ph√¢n b·ªë tr·∫°ng th√°i</h3>
                        <div id="statusChart"></div>
                    </div>

                    <!-- Group Progress -->
                    <div class="analytics-section">
                        <h3>üìÅ Ti·∫øn ƒë·ªô theo nh√≥m</h3>
                        <div id="groupProgress"></div>
                    </div>

                    <!-- Weekly Activity -->
                    <div class="analytics-section">
                        <h3>üìÖ Ho·∫°t ƒë·ªông 7 ng√†y qua</h3>
                        <div id="weeklyChart"></div>
                    </div>

                    <!-- Review Calendar -->
                    <div class="analytics-section">
                        <h3>üóìÔ∏è L·ªãch √¥n t·∫≠p</h3>
                        <div class="review-calendar" id="reviewCalendar"></div>
                    </div>
                </div>
            </section>

            <!-- Import Screen -->
            <section class="screen" id="importScreen">
                <div class="screen-header">
                    <button class="back-btn" onclick="navigateTo('home')">‚Üê Quay l·∫°i</button>
                    <h2>üì• Import t·ª´ Excel</h2>
                </div>

                <div class="import-container">
                    <!-- Group selector for import -->
                    <div class="import-group-selector">
                        <label>Import v√†o nh√≥m:</label>
                        <select id="importGroupSelect">
                            <!-- Groups will be populated -->
                        </select>
                        <button class="btn btn-sm btn-secondary" onclick="openAddGroupModal()">+ T·∫°o nh√≥m</button>
                    </div>

                    <div class="import-info">
                        <h3>üìã H∆∞·ªõng d·∫´n</h3>
                        <p>File Excel c·∫ßn c√≥ c√°c c·ªôt theo th·ª© t·ª±:</p>
                        <table class="format-table">
                            <thead>
                                <tr>
                                    <th>C·ªôt A</th>
                                    <th>C·ªôt B</th>
                                    <th>C·ªôt C</th>
                                    <th>C·ªôt D (t√πy ch·ªçn)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Ch·ªØ H√°n</td>
                                    <td>Pinyin</td>
                                    <td>Nghƒ©a</td>
                                    <td>V√≠ d·ª•</td>
                                </tr>
                                <tr class="example-row">
                                    <td>‰Ω†Â•Ω</td>
                                    <td>n«ê h«éo</td>
                                    <td>Xin ch√†o</td>
                                    <td>‰Ω†Â•ΩÔºåÊàëÊòØÂ∞èÊòé</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="import-dropzone" id="dropzone">
                        <input type="file" id="fileInput" accept=".xlsx,.xls" onchange="handleFileSelect(event)" hidden>
                        <div class="dropzone-content" onclick="document.getElementById('fileInput').click()">
                            <span class="dropzone-icon">üìÅ</span>
                            <p>K√©o th·∫£ file Excel v√†o ƒë√¢y</p>
                            <p class="dropzone-hint">ho·∫∑c click ƒë·ªÉ ch·ªçn file</p>
                        </div>
                    </div>

                    <div class="import-preview" id="importPreview" style="display: none;">
                        <h3>Xem tr∆∞·ªõc d·ªØ li·ªáu</h3>
                        <div class="preview-list" id="previewList"></div>
                        <button class="btn btn-primary" onclick="confirmImportWithGroup()">Import <span
                                id="importCount">0</span> t·ª´</button>
                    </div>
                </div>

                <div class="export-section"
                    style="margin-top: 30px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px;">
                    <h3>üì§ Export d·ªØ li·ªáu</h3>
                    <p style="margin-bottom: 15px; color: var(--text-secondary);">Xu·∫•t to√†n b·ªô t·ª´ v·ª±ng ra file Excel ƒë·ªÉ
                        sao l∆∞u.</p>
                    <button class="btn btn-secondary" onclick="exportToExcel()">
                        üíæ T·∫£i xu·ªëng Excel (.xlsx)
                    </button>
                </div>
    </div>
    </section>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-item active" onclick="navigateTo('home')" data-screen="home">
            <span class="nav-icon">üè†</span>
            <span class="nav-label">Trang ch·ªß</span>
        </button>
        <button class="nav-item" onclick="navigateTo('groups')" data-screen="groups">
            <span class="nav-icon">üìÅ</span>
            <span class="nav-label">Nh√≥m</span>
        </button>
        <button class="nav-item has-badge" onclick="navigateTo('review')" data-screen="review">
            <span class="nav-icon">üîÑ</span>
            <span class="nav-label">√în t·∫≠p</span>
            <span class="nav-badge" id="navReviewBadge"></span>
        </button>
        <button class="nav-item" onclick="navigateTo('analytics')" data-screen="analytics">
            <span class="nav-icon">üìä</span>
            <span class="nav-label">Th·ªëng k√™</span>
        </button>
    </nav>
    </div>

    <!-- Settings Screen (outside app-container for overlay effect) -->
    <section class="screen" id="settingsScreen"
        style="display:none; position:fixed; inset:0; z-index:200; background:var(--bg-primary); overflow-y:auto; padding:24px;">
        <div class="screen-header">
            <button class="back-btn" onclick="navigateTo('home')">‚Üê Quay l·∫°i</button>
            <h2>‚öôÔ∏è C√†i ƒë·∫∑t</h2>
        </div>
        <div class="settings-section">
            <h3>ü§ñ AI G·ª£i √Ω v√≠ d·ª•</h3>
            <p style="color:var(--text-secondary);margin-bottom:12px;font-size:0.9rem">Nh·∫≠p Gemini API Key ƒë·ªÉ d√πng t√≠nh
                nƒÉng AI g·ª£i √Ω c√¢u v√≠ d·ª•. L·∫•y key mi·ªÖn ph√≠ t·∫°i <a href="https://ai.google.dev" target="_blank"
                    style="color:var(--accent-primary)">ai.google.dev</a></p>
            <div class="form-group">
                <label for="geminiApiKey">Gemini API Key</label>
                <input type="password" id="geminiApiKey" placeholder="AIza..." oninput="saveApiKey()">
            </div>
            <div id="apiKeyStatus" style="font-size:0.85rem;margin-top:8px;"></div>
        </div>
    </section>

    <!-- Dictionary Popup -->
    <div class="dict-overlay" id="dictOverlay" onclick="closeDictPopup()" style="display:none;"></div>
    <div class="dict-popup" id="dictPopup" style="display:none;">
        <div class="dict-popup-header">
            <span class="dict-char" id="dictChar"></span>
            <button class="close-btn" onclick="closeDictPopup()">&times;</button>
        </div>
        <div class="dict-popup-body">
            <div class="dict-pinyin" id="dictPinyin"></div>
            <div class="dict-meaning" id="dictMeaning"></div>
            <div class="dict-example" id="dictExample"></div>
            <button class="btn btn-sm btn-secondary"
                onclick="speakChinese(document.getElementById('dictChar').textContent)">üîä Ph√°t √¢m</button>
        </div>
    </div>

    <!-- Add/Edit Vocabulary Modal -->
    <div class="modal" id="vocabModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Th√™m t·ª´ v·ª±ng</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <form id="vocabForm" onsubmit="saveVocabulary(event)">
                <input type="hidden" id="editId">
                <div class="form-group">
                    <label for="inputChinese">Ch·ªØ H√°n *</label>
                    <input type="text" id="inputChinese" required placeholder="‰æã: ‰Ω†Â•Ω">
                </div>
                <div class="form-group">
                    <label for="inputPinyin">Pinyin *</label>
                    <input type="text" id="inputPinyin" required placeholder="‰æã: n«ê h«éo">
                </div>
                <div class="form-group">
                    <label for="inputMeaning">Nghƒ©a ti·∫øng Vi·ªát *</label>
                    <input type="text" id="inputMeaning" required placeholder="‰æã: Xin ch√†o">
                </div>
                <div class="form-group">
                    <label for="inputExample">V√≠ d·ª• (t√πy ch·ªçn)</label>
                    <div class="example-input-row">
                        <input type="text" id="inputExample" placeholder="‰æã: ‰Ω†Â•ΩÔºåÊàëÊòØÂ∞èÊòé">
                        <button type="button" class="btn-ai-suggest" onclick="aiSuggestExample()" id="aiSuggestBtn"
                            title="AI g·ª£i √Ω">
                            <span class="ai-icon">‚ú®</span> AI g·ª£i √Ω
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="inputGroup">Nh√≥m</label>
                    <select id="inputGroup">
                        <!-- Groups will be populated -->
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">H·ªßy</button>
                    <button type="submit" class="btn btn-primary">L∆∞u</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Group Modal -->
    <div class="modal" id="groupModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="groupModalTitle">T·∫°o nh√≥m m·ªõi</h3>
                <button class="close-btn" onclick="closeGroupModal()">&times;</button>
            </div>
            <form id="groupForm" onsubmit="saveGroup(event)">
                <input type="hidden" id="editGroupId">
                <div class="form-group">
                    <label for="groupNameInput">T√™n nh√≥m *</label>
                    <input type="text" id="groupNameInput" required placeholder="‰æã: HSK 1">
                </div>
                <div class="form-group">
                    <label for="groupDescInput">M√¥ t·∫£</label>
                    <input type="text" id="groupDescInput" placeholder="‰æã: T·ª´ v·ª±ng HSK c·∫•p 1">
                </div>
                <div class="form-group">
                    <label>M√†u s·∫Øc</label>
                    <input type="hidden" id="groupColorInput" value="#6366f1">
                    <div class="color-picker" id="colorPicker"></div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeGroupModal()">H·ªßy</button>
                    <button type="submit" class="btn btn-primary">L∆∞u</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Scripts (order matters for dependencies) -->
    <script src="js/vocabulary.js"></script>
    <script src="js/groups.js"></script>
    <script src="js/srs.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/speech.js"></script>
    <script src="js/flashcard.js"></script>
    <script src="js/quiz.js"></script>
    <script src="js/excel-import.js"></script>
    <script src="js/excel-export.js"></script>
    <script src="js/dictionary.js"></script>
    <script src="js/ai.js"></script>
    <script src="js/app.js"></script>
</body>

</html>